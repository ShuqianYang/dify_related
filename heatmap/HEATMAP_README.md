# 🗺️ 动物种类分布热力图系统

基于Leaflet.js + ECharts的动物种类在各摄像头点位的分布热力图可视化系统。

## 📋 系统概述

这是一个专门用于展示动物种类在不同摄像头监测点位分布情况的热力图系统，通过直观的地图可视化帮助用户：

- 🔥 **热力图展示**：显示动物检测的密度分布
- 📍 **摄像头定位**：标记所有监测设备位置
- 🐾 **动物筛选**：按种类查看特定动物分布
- 📊 **实时统计**：提供详细的数据统计信息

## 🚀 快速启动

### 1. 启动服务器
```bash
python heatmap_app.py
```

### 2. 访问系统
打开浏览器访问：`http://127.0.0.1:5003`

## 🏗️ 系统架构

### 后端 (Flask)
- **文件**: `heatmap_app.py`
- **端口**: 5003
- **数据库**: 连接 `mysql_insert` 模块的 `image_info` 表

### 前端 (HTML/JavaScript)
- **文件**: `heatmap/index.html`
- **地图库**: Leaflet.js
- **热力图**: Leaflet.heat 插件

## 📊 API接口

### 1. 热力图数据
```
GET /api/heatmap-data
```
返回所有动物的热力图数据

### 2. 摄像头位置
```
GET /api/sensor-locations
```
返回所有摄像头的位置信息

### 3. 动物统计
```
GET /api/animal-stats
```
返回动物种类统计数据

### 4. 按动物筛选
```
GET /api/heatmap-by-animal/<animal_name>
```
返回特定动物的热力图数据

## 🎯 核心功能

### 🗺️ 地图功能
- **多图层支持**：底图 + 热力图 + 标记点
- **交互操作**：缩放、平移、点击查看详情
- **响应式设计**：适配不同屏幕尺寸

### 🔥 热力图功能
- **动态强度调节**：可调整热力图显示强度
- **半径控制**：可调整热力图影响半径
- **颜色渐变**：蓝色(低密度) → 红色(高密度)
- **实时更新**：支持数据刷新和筛选

### 📍 摄像头标记
- **位置标记**：显示所有摄像头位置
- **详情弹窗**：点击查看摄像头详细信息
- **统计信息**：显示每个点位的检测次数

### 🐾 动物筛选
- **种类列表**：显示所有检测到的动物种类
- **筛选功能**：按动物种类过滤热力图
- **统计展示**：显示每种动物的检测统计

## 🎛️ 控制面板

### 筛选控制
- **动物选择器**：下拉菜单选择特定动物
- **强度滑块**：调整热力图显示强度 (0.1-2.0)
- **半径滑块**：调整热力图影响半径 (10-50px)

### 操作按钮
- **🔄 刷新数据**：重新加载所有数据
- **🎯 重置视图**：恢复默认地图视图
- **🧹 清除热力图**：临时隐藏热力图层

## 📊 统计信息

### 实时统计
- **总检测次数**：所有动物检测的总数
- **摄像头数量**：活跃监测设备数量
- **动物种类**：检测到的不同动物种类数
- **当前筛选**：显示当前选中的筛选条件

### 动物列表
- **种类名称**：动物的具体名称
- **检测次数**：该动物被检测到的总次数
- **摄像头数量**：检测到该动物的摄像头数量
- **平均置信度**：AI识别的平均置信度

## 🎨 界面特色

### 现代化设计
- **渐变背景**：美观的紫色渐变背景
- **毛玻璃效果**：半透明背景和模糊效果
- **圆角设计**：现代化的圆角卡片布局
- **动画效果**：平滑的过渡和悬停动画

### 响应式布局
- **桌面端**：侧边栏 + 主地图区域
- **移动端**：垂直堆叠布局
- **自适应**：根据屏幕尺寸自动调整

## 🔧 技术栈

### 后端技术
- **Flask**: Web框架
- **MySQL Connector**: 数据库连接
- **Flask-CORS**: 跨域支持

### 前端技术
- **Leaflet.js**: 开源地图库
- **Leaflet.heat**: 热力图插件
- **OpenStreetMap**: 地图瓦片服务
- **原生JavaScript**: 交互逻辑

### 数据库
- **MySQL**: 存储动物检测数据
- **image_info表**: 包含位置、动物、置信度等信息

## 📈 数据字段

系统使用 `image_info` 表的以下字段：

- `sensor_id`: 摄像头ID
- `location`: 地理位置名称
- `longitude`: 经度坐标
- `latitude`: 纬度坐标
- `object`: 检测对象类型
- `animal`: 具体动物名称
- `count`: 检测数量
- `confidence`: AI识别置信度
- `percentage`: 识别百分比

## 🌟 系统优势

### 1. 直观可视化
- 热力图直观显示动物分布密度
- 地理位置精确定位监测点
- 颜色编码快速识别高密度区域

### 2. 交互体验
- 流畅的地图操作体验
- 实时数据筛选和更新
- 详细的信息提示和统计

### 3. 数据洞察
- 多维度数据分析
- 动物行为模式识别
- 监测效果评估

### 4. 扩展性强
- 模块化设计易于扩展
- API接口支持二次开发
- 支持多种数据源接入

## 🔮 未来扩展

- **时间维度**：添加时间轴控制，查看不同时期的分布变化
- **更多图表**：集成ECharts添加柱状图、饼图等统计图表
- **数据导出**：支持热力图数据和统计报告导出
- **告警系统**：异常密度区域自动告警
- **移动应用**：开发移动端APP版本

---

🎯 **访问地址**: http://127.0.0.1:5003
📧 **技术支持**: 基于image_info数据库的实时动物分布监测系统