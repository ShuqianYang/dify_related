# 🦁 野生动物监测数据可视化平台

> 基于图像识别技术的野生动物监测数据综合可视化分析系统

## 📋 项目概述

野生动物监测数据可视化平台是一个专为野生动物保护和研究设计的综合性Web应用系统。该平台通过整合图像识别数据，提供地图可视化、实时图表分析等多维度的数据展示功能，帮助研究人员、保护机构和管理部门更好地了解野生动物的分布情况、活动模式和保护状况。

## 🏗️ 系统架构

### 整体架构

```
┌─────────────────────────────────────────────────────────────────┐
│                    野生动物监测数据可视化平台                      │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐              ┌─────────────────┐           │
│  │   地图可视化     │              │   实时图表分析   │           │
│  │   (ECharts_map) │              │ (realtime_chart)│           │
│  │                 │              │                 │           │
│  │ • 地理分布展示   │              │ • 时间序列分析   │           │
│  │ • 交互式弹窗     │              │ • 种类分布统计   │           │
│  │ • 数据筛选       │              │ • 活动模式分析   │           │
│  │ • 统计信息       │              │ • 地点分布统计   │           │
│  └─────────────────┘              └─────────────────┘           │
│           │                                 │                   │
│           └─────────────┬───────────────────┘                   │
│                         │                                       │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    Flask API 服务层                         │ │
│  │                                                             │ │
│  │ • 地图数据API        • 动物列表API      • 实时数据API        │ │
│  │ • 地点详情API        • 时间序列API      • 活动分析API        │ │
│  │ • 统计信息API        • 地理分布API      • 筛选功能API        │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                         │                                       │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    MySQL 数据库                             │ │
│  │                                                             │ │
│  │ • image_info (图像识别数据)                                  │ │
│  │ • animal_list (动物名录)                                     │ │
│  │ • 地理位置信息                                               │ │
│  │ • 时间序列数据                                               │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

### 技术栈

- **后端框架**: Flask (Python)
- **前端技术**: HTML5 + JavaScript + CSS3
- **数据可视化**: ECharts (地图组件 + 图表组件)
- **数据库**: MySQL
- **数据连接**: PyMySQL
- **跨域支持**: Flask-CORS

## 📊 功能模块

### 1. 地图可视化模块 (ECharts_map)

#### 核心功能
- **🗺️ 地理分布展示**: 基于ECharts地图组件，直观展示野生动物在各地区的分布情况
- **💬 交互式弹窗**: 点击地图区域显示详细的动物监测信息
- **🔍 数据筛选**: 支持按动物种类、时间范围等条件筛选数据
- **📊 统计信息**: 实时显示总监测数量、动物种类数等关键指标

#### 技术特性
- 响应式地图设计，支持缩放和平移
- 气泡大小反映监测数量多少
- 悬停效果和点击交互
- 动态数据更新

### 2. 实时图表分析模块 (realtime_chart)

#### 四大核心图表

##### 📈 时间序列趋势图
- **功能**: 展示按日期统计的动物识别数量变化趋势
- **特性**: 支持按动物种类筛选，折线图展示
- **用途**: 分析动物活动的时间规律和季节性变化

##### 🦁 动物种类分布图
- **功能**: 显示不同动物种类的识别数量分布
- **特性**: 支持时间范围筛选（1天/7天/30天/6个月/1年）
- **用途**: 了解各种动物的相对数量和保护优先级

##### 🌍 地理位置分布图
- **功能**: 展示不同地理位置的动物识别数量分布
- **特性**: 支持按动物种类筛选，柱状图展示
- **用途**: 分析动物栖息地分布和热点区域

##### 🕐 动物活动时间分布图
- **功能**: 分析动物在24小时内的活动模式
- **特性**: 支持按动物种类筛选，展示每小时活动频次
- **用途**: 研究动物的昼夜活动规律

#### 实时更新功能
- ✅ 自动定时刷新功能
- ✅ 手动刷新控制
- ✅ 实时状态指示器
- ✅ 启动/停止控制

## 🗂️ 项目结构

```
野生动物监测数据可视化平台/
├── README.md                    # 项目总文档
├── requirements.txt             # Python依赖包
├── 需求文档.md                  # 详细需求说明
├── CreateTable.sql              # 数据库建表脚本
├── test_popup_data.py           # 数据测试脚本
│
├── ECharts_map/                 # 地图可视化模块
│   ├── README.md               # 模块文档
│   ├── echarts_map_app.py      # Flask应用主文件
│   ├── index.html              # 地图页面
│   ├── script.js               # 前端交互逻辑
│   ├── styles.css              # 样式文件
│   ├── db_config.py            # 数据库配置
│   ├── get_map_data.py         # 地图数据获取
│   └── get_animal_list.py      # 动物列表获取
│
├── realtime_chart/             # 实时图表模块
│   ├── README.md               # 模块文档
│   ├── realtime_chart_app.py   # Flask应用主文件
│   ├── index.html              # 图表页面
│   ├── script.js               # 前端交互逻辑
│   ├── styles.css              # 样式文件
│   ├── db_config.py            # 数据库配置
│   ├── get_realtime_data.py    # 实时数据获取
│   ├── get_activity_data.py    # 活动数据获取
│   ├── get_location_data.py    # 位置数据获取
│   ├── get_timeseries_data.py  # 时序数据获取
│   └── get_animal_list.py      # 动物列表获取
│
└── 启动脚本/
    ├── echarts_map_app.py      # 地图模块启动器
    └── realtime_chart_app.py   # 图表模块启动器
```

## 🚀 快速开始

### 1. 环境要求

- **Python**: 3.7+
- **MySQL**: 5.7+
- **浏览器**: Chrome/Firefox/Safari (支持ES6)

### 2. 安装依赖

```bash
# 克隆项目
git clone [项目地址]
cd 野生动物监测数据可视化平台

# 安装Python依赖
pip install -r requirements.txt
```

### 3. 数据库配置

#### 创建数据库和表
```bash
mysql -u root -p < CreateTable.sql
```

#### 配置数据库连接
分别修改两个模块的 `db_config.py` 文件：

```python
def get_db_config():
    return {
        'host': 'localhost',        # 数据库主机
        'user': 'your_username',    # 数据库用户名
        'password': 'your_password', # 数据库密码
        'database': 'your_database', # 数据库名
        'port': 3306,               # 端口号
        'charset': 'utf8mb4'        # 字符集
    }
```

### 4. 启动应用

#### 启动地图可视化模块
```bash
python echarts_map_app.py
```
访问: http://127.0.0.1:5002

#### 启动实时图表模块
```bash
python realtime_chart_app.py
```
访问: http://127.0.0.1:5003

### 5. 数据导入

系统已预置国家重点保护野生动物名录数据，包括：
- 扬子鳄、大熊猫、金丝猴等一级保护动物
- 猕猴、黑熊、小熊猫等二级保护动物
- 详细的保护级别和描述信息

## 📡 API接口文档

### 地图可视化模块 API

#### 1. 获取地图数据
```
GET /api/map-data?animal={动物名称}&days={天数}
```

#### 2. 获取地点详情
```
GET /api/location-detail?location={地点名称}&animal={动物名称}
```

#### 3. 获取动物列表
```
GET /api/animal-list
```

#### 4. 获取地点列表
```
GET /api/location-list
```

### 实时图表模块 API

#### 1. 动物种类分布数据
```
GET /api/chart-data?days={天数}
```

#### 2. 活动时间分布数据
```
GET /api/activity-data?animal={动物名称}
```

#### 3. 地理位置分布数据
```
GET /api/location-data?animal={动物名称}
```

#### 4. 时间序列数据
```
GET /api/timeseries-data?animal={动物名称}
```

## 🎨 界面设计

### 设计理念
- **现代化**: 采用扁平化设计风格
- **响应式**: 支持桌面端和移动端访问
- **直观性**: 清晰的数据可视化展示
- **交互性**: 丰富的用户交互功能

### 主题色彩
- **主色调**: 蓝色系 (#007bff, #0056b3)
- **辅助色**: 绿色 (#28a745)、红色 (#dc3545)
- **背景色**: 浅灰色 (#f8f9fa)

## 🔧 核心功能实现

### 数据处理逻辑

#### 地图数据统计
```python
# 统计每个地点的动物总数量（基于count字段求和）
SELECT location, SUM(count) as total_count 
FROM image_info 
GROUP BY location
```

#### 弹窗详情数据
```python
# 获取特定地点的详细监测记录
SELECT animal, count, description, date 
FROM image_info 
WHERE location = %s
ORDER BY date DESC
```

#### 时间序列分析
```python
# 按日期统计动物识别数量变化
SELECT date, SUM(count) as daily_count 
FROM image_info 
GROUP BY date 
ORDER BY date
```

### 前端交互逻辑

#### 地图交互
- 鼠标悬停显示地点信息
- 点击显示详细弹窗
- 气泡大小反映数据量
- 支持地图缩放和平移

#### 图表交互
- 实时数据更新
- 筛选条件联动
- 图表类型切换
- 数据导出功能

## 📊 数据库设计

### 核心表结构

#### image_info (图像识别数据表)
```sql
CREATE TABLE image_info (
    id INT AUTO_INCREMENT PRIMARY KEY,
    animal VARCHAR(100) NOT NULL,      -- 动物名称
    location VARCHAR(100) NOT NULL,    -- 地理位置
    count INT DEFAULT 1,               -- 动物数量
    description TEXT,                  -- 描述信息
    date DATE NOT NULL,                -- 监测日期
    time TIME,                         -- 监测时间
    INDEX idx_animal (animal),
    INDEX idx_location (location),
    INDEX idx_date (date)
);
```

#### animal_list (动物名录表)
```sql
CREATE TABLE animal_list (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE, -- 动物名称
    protection_level VARCHAR(20),       -- 保护级别
    description TEXT                    -- 描述信息
);
```

## 🧪 测试

### 数据测试
```bash
# 运行数据一致性测试
python test_popup_data.py
```

### 功能测试
- 地图数据加载测试
- 弹窗交互测试
- 图表渲染测试
- API接口测试

## ⚡ 性能优化

### 数据库优化
- 添加必要的索引
- 优化SQL查询语句
- 使用连接池管理

### 前端优化
- 图表懒加载
- 数据缓存机制
- 响应式图片处理

### 网络优化
- API响应压缩
- 静态资源CDN
- 浏览器缓存策略

## 🔒 安全考虑

### 数据安全
- SQL注入防护
- 输入参数验证
- 敏感信息加密

### 访问控制
- API访问限制
- 跨域请求控制
- 用户权限管理

## 📈 更新日志

### v3.1 (最新版本)
- ✅ 修复弹窗数据统计逻辑
- ✅ 优化"监测总数"显示
- ✅ 增强数据一致性验证
- ✅ 完善项目文档

### v3.0
- ✅ 新增实时图表分析模块
- ✅ 增加四大核心图表
- ✅ 实现自动数据更新
- ✅ 优化用户界面设计

### v2.0
- ✅ 完善地图可视化功能
- ✅ 增加交互式弹窗
- ✅ 实现数据筛选功能
- ✅ 添加统计信息面板

## 🤝 贡献指南

### 开发规范
1. 遵循PEP 8 Python编码规范
2. 使用有意义的变量和函数命名
3. 添加必要的注释和文档
4. 提交前进行代码测试

### 提交流程
1. Fork 项目仓库
2. 创建功能分支
3. 提交代码更改
4. 创建 Pull Request

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## 📞 联系方式

- **项目维护者**: [维护者姓名]
- **邮箱**: [联系邮箱]
- **项目地址**: [GitHub仓库地址]

---

**🌟 如果这个项目对您有帮助，请给我们一个 Star！**